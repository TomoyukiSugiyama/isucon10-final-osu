# See: https://gist.github.com/progfay/25edb2a9ede4ca478cb3e2422f1f12f6#bot-%E3%81%8B%E3%82%89%E3%81%AE%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88
# See: http://nginx.org/en/docs/http/ngx_http_map_module.html


server {
    root /home/isucon/webapp/frontend;
    listen 80 default_server;
    listen [::]:80 default_server;

    location /xsuportal.proto.services.bench.BenchmarkQueue {
            proxy_pass http://localhost:50051;
    }

    location /xsuportal.proto.services.bench.BenchmarkReport {
            proxy_pass http://localhost:50051;
    }

    location / {
            proxy_pass http://localhost:9292;
    }

    location /status {
        stub_status;
        access_log off;
        allow 127.0.0.1;
        deny all;
    }
}
